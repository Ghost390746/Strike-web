<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Strike Project Generator</title>
  <style>
    body { font-family: sans-serif; max-width: 700px; margin: 50px auto; padding: 20px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    select, input, textarea { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { margin-top: 20px; padding: 12px 25px; font-size: 16px; cursor: pointer; border: none; background-color: #007bff; color: white; border-radius: 5px; }
    button:disabled { background-color: #aaa; cursor: not-allowed; }
    #status { margin-top: 20px; padding: 10px; border-radius: 5px; background-color: #f5f5f5; min-height: 30px; }
    a.artifact-link { color: #007bff; text-decoration: none; }
    a.artifact-link:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>Strike Project Generator</h1>
  <form id="strikeForm">
    <label for="framework">Select Framework:</label>
    <select id="framework" name="framework">
      <option>Express</option>
      <option>Fastify</option>
      <option>Koa</option>
      <option>Next.js</option>
      <option>Vite</option>
      <option>NestJS</option>
      <option>Hapi</option>
      <option>Sapper</option>
      <option>AdonisJS</option>
      <option>FeathersJS</option>
      <option>LoopBack</option>
      <option>Flask</option>
      <option>Django</option>
      <option>FastAPI</option>
    </select>

    <label for="description">Project Description:</label>
    <textarea id="description" name="description" rows="4" placeholder="Describe your project"></textarea>

    <label for="token">GitHub Personal Access Token:</label>
    <input type="password" id="token" placeholder="ghp_xxx..." required>

    <label for="repoOwner">GitHub Repository Owner:</label>
    <input type="text" id="repoOwner" placeholder="e.g., yourusername" required>

    <label for="repoName">GitHub Repository Name:</label>
    <input type="text" id="repoName" placeholder="e.g., strike-web" required>

    <button type="submit">Generate Project</button>
  </form>

  <div id="status"></div>

  <script>
    const form = document.getElementById("strikeForm");
    const status = document.getElementById("status");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const framework = document.getElementById("framework").value;
      const description = document.getElementById("description").value;
      const token = document.getElementById("token").value;
      const repoOwner = document.getElementById("repoOwner").value;
      const repoName = document.getElementById("repoName").value;
      const workflowId = "strike-generator.yml"; // workflow filename in repo

      if (!framework || !description || !token || !repoOwner || !repoName) {
        status.textContent = "❌ Please fill in all required fields.";
        return;
      }

      status.textContent = "⏳ Triggering GitHub Actions workflow...";
      form.querySelector("button").disabled = true;

      try {
        const res = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/actions/workflows/${workflowId}/dispatches`, {
          method: "POST",
          headers: {
            "Accept": "application/vnd.github+json",
            "Authorization": `token ${token}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            ref: "main",
            inputs: { framework, description }
          })
        });

        if (res.ok) {
          status.innerHTML = "✅ Workflow triggered successfully!<br>Check your GitHub Actions tab for the project artifact.";
        } else {
          const err = await res.json();
          status.textContent = "❌ Failed to trigger workflow: " + (err.message || res.statusText);
        }
      } catch (err) {
        status.textContent = "❌ Error: " + err.message;
      } finally {
        form.querySelector("button").disabled = false;
      }
    });
  </script>
</body>
</html>
